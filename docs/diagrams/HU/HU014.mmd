graph TB
    %% HU-014: Mark Order Ready (High contrast)
    subgraph "Input Adapters"
        REST["ðŸŒ REST Controller\nPUT /api/v1/orders/{id}/ready"]
    end

    subgraph "Application Layer"
        HANDLER["ðŸ“‹ OrderReadyHandler"]
        RES_DTO["ðŸ“¥ OrderResponseDto"]
        RES_MAP["ðŸ”„ IOrderResponseMapper"]
    end

    subgraph "Domain Core"
        USECASE["âš™ï¸ MarkOrderReadyUseCase (generate PIN)"]
        API["ðŸ”Œ IOrderServicePort (IN)"]
        SPI_PERSIST["ðŸ”Œ IOrderPersistencePort (OUT)"]
        SPI_EVENT["ðŸ”Œ IOrderEventPublisherPort (OUT)"]
        MODEL["ðŸ“Š Order, OrderStatus"]
    end

    subgraph "Driven Adapters"
        JPA_ADAPTER["ðŸ’¾ OrderJpaAdapter (findById, save)"]
        EVENT_ADAPTER["ðŸ“¨ NoOpOrderEventPublisherAdapter (to Messaging MS later)"]
    end

    REST --> HANDLER
    HANDLER --> USECASE
    USECASE --> SPI_PERSIST
    USECASE --> SPI_EVENT
    SPI_PERSIST --> JPA_ADAPTER
    SPI_EVENT --> EVENT_ADAPTER

    classDef domain fill:#e1f5fe,stroke:#0277bd,stroke-width:3px,color:#000000
    classDef app fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000000
    classDef infra fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,color:#000000

    class USECASE,API,SPI_PERSIST,SPI_EVENT,MODEL domain
    class HANDLER,RES_DTO,RES_MAP app
    class REST,JPA_ADAPTER,EVENT_ADAPTER infra
